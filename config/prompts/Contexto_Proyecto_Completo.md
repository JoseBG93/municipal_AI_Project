# Contexto Proyecto Completo - Sistema Municipal IA Alfafar
## Memoria Contextual Integral y Actualizada

---

## 📋 INFORMACIÓN BÁSICA DEL PROYECTO

### **👤 PERFIL USUARIO PRINCIPAL**

**🏛️ José - Funcionario Inspección Tributaria:**
```markdown
DATOS PROFESIONALES:
- Puesto: Auxiliar administrativo interino
- Departamento: Inspección Tributaria - Ayuntamiento de Alfafar
- Ubicación: Valencia, España
- Especialidad diaria: IIVTNU (Incremento Valor Terrenos Naturaleza Urbana)
- Experiencia práctica: Manejo diario escrituras, herencias, donaciones, documentación notarial/judicial

OBJETIVO PROFESIONAL:
- Principal: Aprobar oposiciones auxiliar administrativo permanente
- Secundario: Desarrollar competencias técnicas avanzadas (programación, IA)
- Estratégico: Liderar transformación digital departamental

PERFIL FORMATIVO ACTUAL:
- ✅ Master Inteligencia Artificial (BigSchool) - FINALIZADO
- 🔄 Master Full-Stack Programming (Conquer Blocks) - EN CURSO
- 🔄 Cursos EDTeam: Docker, DevOps, Data Science, Python, ML, CI/CD
- 🎯 Objetivo idiomas: Nivel C1 inglés

STACK TÉCNICO ACTUAL:
- Familiarizado: Python, Linux/Bash, Docker (conceptos), SQL básico
- En aprendizaje: Java, JavaScript, frameworks web
- Herramientas diarias: GTT, Gestiona, Outlook, Office 365
- Preferencias: Metodología estructurada paso a paso
```

### **🏛️ ENTORNO MUNICIPAL ALFAFAR**

**📍 Contexto Institucional:**
```markdown
AYUNTAMIENTO DE ALFAFAR:
- Provincia: Valencia, Comunidad Valenciana
- Tipología: Municipio mediano (aprox. 21.000 habitantes)
- Características: Zona metropolitana Valencia, actividad económica diversa

DEPARTAMENTO INSPECCIÓN TRIBUTARIA:
- Personal: Limitado (2 funcionarios técnicos principales)
- Volumen trabajo: Alto (especialmente épocas declaraciones)
- Herramientas principales: GTT (gestión tributaria), Gestiona (registro/tramitación)
- Documentación procesada: Escrituras notariales, documentos judiciales, autoliquidaciones

CARACTERÍSTICAS OPERATIVAS:
- Procesamiento manual actual: Alto volumen documentos
- Errores humanos: Riesgo inherente trabajo repetitivo
- Tiempos tramitación: Mejorables con automatización
- Servicio ciudadano: Potencial mejora significativa
```

---

## 🏛️ RÉGIMEN TRIBUTARIO MUNICIPAL COMPLETO

### **💰 IMPUESTOS MUNICIPALES (TODOS)**

**🎯 Tributos principales gestionados:**
```markdown
1. IIVTNU (Especialidad diaria José):
   - Incremento Valor Terrenos Naturaleza Urbana ("plusvalía municipal")
   - Casos típicos: Compraventas, herencias, donaciones
   - Complejidad: Cálculos coeficientes actualización, exenciones
   - Volumen: Alto en épocas declaraciones

2. IBI (Impuesto Bienes Inmuebles):
   - Base: Valores catastrales actualizados
   - Casos uso: Verificación valoraciones, bonificaciones aplicables
   - Integración: Catastro + Registro Propiedad

3. IAE (Impuesto Actividades Económicas):
   - Aplicación: Empresas y profesionales
   - Complejidad: Epígrafes, tarifas, reducciones
   - Detección: Actividades no declaradas

4. ICIO (Impuesto Construcciones, Instalaciones, Obras):
   - Aplicación: Licencias urbanísticas
   - Cálculo: Presupuestos obra, tipos gravamen
   - Integración: Urbanismo municipal

5. IVTM (Impuesto Vehículos Tracción Mecánica):
   - Base: Potencias fiscales, antigüedad
   - Exenciones: Vehículos históricos, discapacidad
   - Integración: DGT + sistemas municipales
```

### **📊 TASAS MUNICIPALES (TODAS)**

**🎯 Servicios municipales gravados:**
```markdown
SERVICIOS ADMINISTRATIVOS:
- Expedición documentos administrativos
- Certificaciones, copias compulsadas
- Tramitación licencias y permisos

SERVICIOS URBANOS:
- Suministro agua potable
- Alcantarillado y depuración
- Recogida, transporte, tratamiento basuras/residuos
- Limpieza vía pública

SERVICIOS ESPECIALES:
- Cementerio municipal, servicios funerarios
- Vado permanente vía pública
- Ocupación vía pública (mesas/sillas terrazas)
- Mercados municipales, puestos comerciales

LICENCIAS Y AUTORIZACIONES:
- Licencias urbanísticas (obras menores/mayores)
- Licencias actividades clasificadas
- Licencias espectáculos públicos
- Autorizaciones ocupación temporal

SERVICIOS SOCIALES Y CULTURALES:
- Servicios deportivos municipales
- Escuelas municipales (música, idiomas)
- Actividades culturales y recreativas
- Residencia asistida municipal

SERVICIOS AMBIENTALES:
- Dejallería municipal (punto limpio)
- Parques y jardines (usos especiales)
- Playas (donde aplique)
- Control ambiental actividades
```

### **⚖️ MARCO NORMATIVO APLICABLE**

**📜 Legislación principal:**
```markdown
ESTATAL:
- LRHL (Ley Reguladora Haciendas Locales) - Marco general
- Ley General Tributaria - Procedimientos
- Texto Refundido Catastro Inmobiliario

AUTONÓMICO:
- Normativa fiscal Comunidad Valenciana
- Procedimientos específicos interadministrativos

MUNICIPAL:
- Ordenanzas fiscales Ayuntamiento Alfafar (específicas)
- Reglamento orgánico municipal
- Bandos y disposiciones complementarias

PROTECCIÓN DATOS Y IA:
- RGPD (Reglamento UE) - Aplicación directa
- LOPDGDD (España) - Especificidades nacionales
- AI Act (UE) - Entrada vigor progresiva 2025-2026
- ENS (Esquema Nacional Seguridad) - Nivel MEDIO
```

---

## 🎯 OBJETIVOS Y FINALIDADES DEL SISTEMA

### **🚀 OBJETIVO PRINCIPAL**
```markdown
AUTOMATIZACIÓN INTEGRAL:
Desarrollar sistema IA para procesamiento automático documentos notariales 
y cálculo tributos municipales, eliminando procesamiento manual, reduciendo 
errores humanos y acelerando trámites fiscales para ciudadanos.

CARACTERÍSTICAS CLAVE:
- Cobertura: TODO el régimen tributario municipal (no solo IIVTNU)
- Escalabilidad: Extensible otros departamentos municipales
- Compliance: Cumplimiento normativo desde día 1
- Usabilidad: Adaptado nivel técnico funcionarios municipales
```

### **📊 MÉTRICAS ESPERADAS**
```markdown
IMPACTO OPERATIVO:
- ⚡ Reducción 90% tiempo procesamiento documentos
- 🎯 Precisión >95% extracción datos automática
- 💰 Ahorro 80% costes administrativos
- 📈 Incremento 300% productividad funcionarios
- ❌ Reducción 95% errores humanos en cálculos

BENEFICIOS CIUDADANOS:
- ⏱️ Trámites más rápidos (reducción tiempo espera)
- ✅ Mayor precisión liquidaciones (menos errores)
- 🔍 Transparencia algoritmos (comprensión decisiones)
- 🌐 Portal autoservicio 24/7 consultas
- 📱 Notificaciones automáticas estado expedientes
```

---

## 🔧 TAREAS Y PROCESOS A AUTOMATIZAR

### **📄 DOCUMENTACIÓN TRIBUTARIA**
```markdown
TIPOS DOCUMENTOS PRINCIPALES:
✅ Escrituras compraventa (volumen alto)
✅ Documentos aceptación herencia
✅ Escrituras donación inmuebles
✅ Documentos judiciales/notariales diversos
✅ Autoliquidaciones ciudadanos
✅ Declaraciones actividades económicas IAE

PROCESAMIENTO AUTOMÁTICO:
1. Recepción documento (PDF/Word/escaneado)
2. OCR optimizado (Tesseract + ML post-procesado)
3. Extracción datos estructurada (LLM + NER)
4. Validación cruzada bases datos municipales
5. Cálculo automático tributos aplicables
6. Generación liquidación/notificación
7. Integración GTT/Gestiona automática
```

### **🔍 EXTRACCIÓN DATOS CLAVE**
```markdown
ENTIDADES PRINCIPALES:
👤 PERSONAS:
- DNI/NIE/CIF (validación formato + dígito control)
- Nombres completos (normalización)
- Direcciones fiscales (geocodificación)
- Relaciones jurídicas (comprador/vendedor, heredero, etc.)

🏠 INMUEBLES:
- Referencias catastrales (validación formato)
- Direcciones postales completas
- Superficies (construida, útil, parcela)
- Valores declarados/catastrales
- Uso/destino (vivienda, local, industrial)

💰 IMPORTES ECONÓMICOS:
- Precios transmisión (conversión letras→números)
- Valoraciones periciales
- Bases imponibles calculadas
- Deducciones/bonificaciones aplicables
- Cuotas resultantes

📅 FECHAS RELEVANTES:
- Otorgamiento escrituras (validación coherencia)
- Transmisión efectiva
- Inicio actividades económicas
- Vencimientos tributarios

⚖️ CONCEPTOS TRIBUTARIOS:
- Tipos gravamen aplicables
- Exenciones/bonificaciones procedentes
- Plazos presentación/pago
- Recargos/intereses si procede
```

### **🔗 INTEGRACIÓN SISTEMAS MUNICIPALES**
```markdown
GTT (GESTIÓN TRIBUTARIA):
- Input: Datos estructurados documentos procesados
- Output: Liquidaciones generadas automáticamente
- Validación: Cruce bases datos municipal
- Alertas: Inconsistencias detectadas para revisión humana

GESTIONA (REGISTRO/TRAMITACIÓN):
- Input: Expedientes documentos registrados
- Output: Estado tramitación actualizado
- Workflow: Flujos automáticos según tipo documento
- Trazabilidad: Histórico completo actuaciones

CORREOS.ES (PEE):
- Descarga automática Pruebas Entrega Electrónica
- Procesamiento rangos fechas configurables
- Identificación PEE pendientes gestión
- Almacenamiento local organizado
- Vinculación expedientes GTT/Gestiona

BASES CATASTRALES:
- Verificación referencias catastrales
- Actualización valores automática
- Detección modificaciones relevantes
- Cruce datos declarados vs oficiales
```

---

## 🏗️ ARQUITECTURA TÉCNICA ESTABLECIDA

### **🐳 DOCKER SWARM CONFORME NORMATIVA**

**🔧 Configuración arquitectónica:**
```markdown
CLUSTER HÍBRIDO:
- Manager+Worker: Servidor físico municipal (datos críticos)
- Worker adicional: Servidor físico backup/balanceo
- Cloud UE: Procesamiento datos anonimizados (compliance RGPD)

SEGREGACIÓN POR SENSIBILIDAD:
🔴 NIVEL CRÍTICO (On-Premise exclusivo):
- DNI/NIE/CIF ciudadanos
- Escrituras originales completas
- Valores económicos reales
- Referencias catastrales exactas
- Bases datos tributarias

🟡 NIVEL MEDIO (Cloud UE conforme):
- Documentos anonimizados para OCR/IA
- Modelos ML entrenamiento
- Procesamiento estadístico agregado
- Logs auditoria (datos hash)

🟢 NIVEL PÚBLICO (Cloud global):
- Servicios ciudadanos sin datos sensibles
- Portal información municipal
- Chatbots información general
- Contenido estático web
```

### **🏗️ MICROSERVICIOS PRINCIPALES**
```markdown
DOCUMENT_PROCESSOR:
- Función: OCR + extracción datos (Tesseract + Custom NER)
- Tecnología: Python + spaCy + LangChain + OpenAI LLMs
- Datos: Solo documentos nivel MEDIO (anonimizados)
- Escalabilidad: Horizontal según carga

TAX_CALCULATOR:
- Función: Cálculos automáticos impuestos/tasas
- Cobertura: TODAS las figuras tributarias municipales
- Tecnología: Python + FastAPI + PostgreSQL
- Datos: Nivel CRÍTICO (on-premise exclusivo)

INTEGRATION_LAYER:
- Función: Conectores GTT/Gestiona + APIs municipales
- Tecnología: Python + FastAPI + message queues
- Datos: Interfaz entre niveles crítico-medio
- Seguridad: Cifrado extremo a extremo

WEB_INTERFACE:
- Función: Frontend administrativo + portal ciudadano
- Tecnología: Django Admin + Bootstrap + htmx
- Datos: Según perfil usuario (funcionario vs ciudadano)
- UX: Adaptado funcionarios municipales
```

### **🔒 SEGURIDAD Y CIFRADO**
```markdown
CIFRADO EN REPOSO:
- AES-256-GCM para datos críticos
- TDE (Transparent Data Encryption) PostgreSQL
- Claves rotativas automáticas HSM
- Backups cifrados independientes

CIFRADO EN TRÁNSITO:
- TLS 1.3 mínimo todas comunicaciones
- Certificados X.509 con Perfect Forward Secrecy
- mTLS entre microservicios
- VPN IPSec para comunicaciones externas

CONTROL ACCESO:
- Roles granulares por funcionario
- Autenticación multifactor obligatoria
- Logs auditoría todas las acciones
- Revisión accesos trimestral
```

---

## 📊 ESTADO ACTUAL DEL PROYECTO

### **✅ PROGRESO DOCUMENTACIÓN LEGAL-COMPLIANCE**
```markdown
COMPLETADOS (8/13 archivos - 62%):
01. ✅ Marco_Normativo_Completo.md
02. ✅ Principios_Fundamentales_Aplicacion.md
03. ✅ Arquitectura_Tecnica_Conforme.md
04. ✅ Documentacion_Obligatoria.md
05. ✅ Medidas_Tecnicas_Organizativas.md
06. ✅ Derechos_Ciudadanos_Implementacion.md
07. ✅ Transferencias_Internacionales.md
08. ✅ Regulacion_IA_Especifica.md

PRÓXIMO ARCHIVO:
09. 🔄 Procedimientos_Operativos.md

PENDIENTES (5/13):
10. Gestion_Incidentes.md
11. Argumentos_Anti_Excusas.md
12. Metricas_Cumplimiento.md
13. Formacion_Obligatoria.md
```

### **🛠️ ESTADO TÉCNICO DESARROLLO**
```markdown
INFRAESTRUCTURA BASE:
✅ Entorno Docker configurado y funcional
✅ Estructura modular operativa en apps/
✅ Scripts utilidades y testing implementados
✅ Datos sintéticos prueba generados
✅ Documentación legal-compliance avanzada

PRÓXIMOS PASOS TÉCNICOS:
🔄 Instalación dependencias reales producción
🔄 Implementación módulos OCR básicos
🔄 Conexión bases datos municipales (testing)
🔄 Desarrollo APIs integración GTT/Gestiona
🔄 Testing end-to-end flujos automatizados
```

---

## 🎓 METODOLOGÍA TRABAJO ESTABLECIDA

### **📚 PRINCIPIOS PEDAGÓGICOS**
```markdown
ENFOQUE JOSÉ (Extraído chat "Qué es Docker Swarm"):
1. ✅ Responder cada cuestión POR SEPARADO hasta comprensión total
2. ✅ Profundizar conceptos hasta confirmación entendimiento completo
3. ✅ Permitir debate, exploración, aclaración cada tema antes avanzar
4. ✅ UNA pregunta → UNA respuesta completa (no bloques múltiples)
5. ✅ Actuar como mentor técnico impulse aprendizaje continuo

CARACTERÍSTICAS ESPECÍFICAS:
- Nivel adaptado: Explicaciones técnicas accesibles
- Ejemplos prácticos: Casos municipales reales
- Ritmo flexible: Sin cronogramas rígidos (proyecto largo plazo)
- Enfoque integral: TODO régimen tributario (no solo IIVTNU)
- Transparencia: Dudas por pequeñas que sean → consultar
```

### **⏰ CONTEXTO TEMPORAL CRÍTICO**
```markdown
FECHA ACTUAL: 1 agosto 2025, 11:25h

PRINCIPIOS TEMPORALES:
❗ OBLIGATORIO: Verificar fecha actual antes mencionar cualquier fecha
📅 Proyecto largo plazo: Sin fechas límite estrictas
👤 José NO dedicación exclusiva: Limitaciones tiempo trabajo diario
🔄 Ritmo pausado: Flexible según disponibilidad usuario
📊 Estado actual: 62% documentación legal-compliance completada

PROTOCOLO INICIO CUALQUIER CHAT:
1. Verificar fecha/hora actual (comando date)
2. Revisar estado real proyecto (listar archivos)
3. Actualizar memoria proyecto información precisa
4. Solo entonces proceder trabajo
```

### **🎯 FOCO DESARROLLO**
```markdown
ENFOQUE SISTEMA INTEGRAL:
❌ NO enfocar exclusivamente IIVTNU (aunque especialidad José)
✅ Sistema debe contemplar TODO régimen tributario municipal
✅ Ejemplos casos uso: Incluir múltiples figuras tributarias
✅ Desarrollo técnico: Arquitectura escalable todas las áreas
✅ Cumplimiento normativo: Marco aplicable integral

ESTRATEGIAS DESARROLLO:
- MCP (Model Context Protocol): Flujo trabajo tributario
- LLM: Extracción información estructurada documentos
- Integración segura: Herramientas ayuntamiento existentes
- Escalabilidad: Otras áreas administrativas (vados, licencias)
- Compliance: Normativa estricta desde fase inicial
```

---

## 📞 RECURSOS Y CONTACTOS ÚTILES

### **🌐 FUENTES NORMATIVAS OFICIALES**
```markdown
EUROPEAS:
- EUR-Lex: eur-lex.europa.eu (normativa UE)
- EDPB: edpb.europa.eu (protección datos)

NACIONALES:
- BOE: boe.es (normativa española)
- AEPD: aepd.es (protección datos)
- CCN-CERT: ccn-cert.cni.es (ciberseguridad)

AUTONÓMICAS:
- DOGV: dogv.gva.es (Comunidad Valenciana)
- Portal transparencia GVA

MUNICIPALES:
- BOP Valencia: bop.dival.es
- Portal municipal Alfafar
- Ordenanzas fiscales municipales
```

### **📚 CASOS ÉXITO REFERENCIA**
```markdown
ADMINISTRACIONES PÚBLICAS IA:
- FEMP: Federación Española Municipios y Provincias
- Red DTI: Directores TI Administraciones Públicas
- OBSAE: Observatorio Administración Electrónica
- CNIS: Congreso Nacional Innovación y Servicios Públicos

CONTACTOS INSTITUCIONALES:
- DPO externos experiencia municipal
- Consultores ciberseguridad especializados
- Universidades líneas investigación IA + AAPP
- Colegios profesionales (ingenieros, abogados, economistas)
```

---

## 🔄 LECCIONES APRENDIDAS CONTEXTUALES

### **🐳 DOCKER SWARM - CONOCIMIENTO ASENTADO**
```markdown
CONCEPTOS DOMINADOS:
✅ Cluster = servidores coordinados
✅ Manager números impares (evitar split-brain)
✅ Workers ejecutan contenedores según asignación Manager
✅ Réplicas = copias servicio específico (NO docker-compose completo)
✅ Balanceo solo nuevas requests (no redistribuye trabajo en curso)
✅ Stateful vs Stateless (datos permanentes vs operaciones temporales)

CONFIGURACIÓN ÓPTIMA ALFAFAR:
- 1 Manager+Worker + 1 Worker (2 servidores físicos)
- Distribución automática según carga/restricciones
- Escalado manual: Usuario decide réplicas, Manager distribuye
- Alta disponibilidad: Tolerancia fallos hardware/servicios
```

### **⚖️ ASPECTOS LEGALES CRÍTICOS**
```markdown
PRINCIPIOS NO NEGOCIABLES:
✅ Base legal específica cada uso IA
✅ Supervisión humana decisiones relevantes (sanciones >300€)
✅ Transparencia activa hacia ciudadanos
✅ Minimización datos estricta
✅ Auditabilidad completa decisiones
✅ Reversibilidad todas decisiones automatizadas
✅ Explicabilidad comprensible funcionarios y ciudadanos
✅ Seguridad by design extremo a extremo

RESISTENCIAS IDENTIFICADAS:
❌ "Excusa protección datos para no cambiar"
❌ Falta formación funcionarios IA
❌ Miedo al cambio por conveniencia/desconocimiento
✅ Necesidad enfoque estratégico: ATACAR con datos casos éxito
```

---

## 🎯 APLICACIONES MUNICIPALES ACTUALES

### **💼 HERRAMIENTAS TRABAJO DIARIO**
```markdown
COMUNICACIONES:
- Outlook: Comunicaciones internas departamento
- Correos.es: PEE (Pruebas Entrega Electrónica) + acuses recibo

GESTIÓN DOCUMENTAL:
- Word/Excel: Documentación administrativa
- GTT: Sistema gestión tributaria principal (trabajo diario)
- Gestiona: Registro y tramitación expedientes

INTEGRACIÓN FUTURA IA:
- APIs GTT: Importación datos liquidaciones automáticas
- APIs Gestiona: Actualización estado expedientes
- APIs Correos: Descarga automática PEE por fechas
- APIs Catastro: Verificación referencias + valores
```

### **🏛️ CASOS USO ESPECÍFICOS ALFAFAR**
```markdown
CARACTERÍSTICAS MUNICIPALES:
- Propiedades históricas: Centro urbano antiguo
- Actividades estacionales: Turismo residencial
- Situaciones especiales: Herencias, divorcios, embargos
- Volumen épocas: Picos declaraciones tributarias
- Personal limitado: Optimización recursos crítica

OPORTUNIDADES AUTOMATIZACIÓN:
- Procesamiento masivo escrituras épocas altas
- Detección automática inconsistencias valoraciones
- Generación avisos/notificaciones automáticas
- Estadísticas gestión tiempo real
- Portal ciudadano consultas 24/7
```

---

## 📋 INSTRUCCIONES ASISTENTE PRÓXIMOS CHATS

### **🚀 PROTOCOLO INICIO SESIÓN**
```markdown
OBLIGATORIO SIEMPRE:
1. ✅ Verificar fecha/hora actual
2. ✅ Revisar estado real proyecto
3. ✅ Actualizar memoria información precisa
4. ✅ Solo entonces proceder trabajo

METODOLOGÍA RESPUESTA:
- Una consulta → Una respuesta completa
- Profundización hasta comprensión confirmada
- Ejemplos municipales múltiples figuras tributarias
- Adaptación nivel técnico José
- Consideración limitaciones tiempo
```

### **🎯 CONFIGURACIÓN ESPECÍFICA**
```markdown
LENGUAJE: Español, terminología administrativa española
EJEMPLOS: Incluir múltiples figuras tributarias siempre
ANALOGÍAS: Contexto funcionario público cuando útil
PROFUNDIDAD: Explorar conceptos hasta comprensión total
REALISMO: Limitaciones administrativas reales
ENFOQUE: TODO régimen tributario municipal (no solo IIVTNU)
```

---

**📅 Documento actualizado**: 1 agosto 2025, 11:25h  
**🔄 Estado actual**: 8/13 archivos legal-compliance completados (62%)  
**📧 Responsable**: José - Inspección Tributaria Alfafar  
**🎯 Versión**: 2.0 - Contexto integral optimizado  
**📊 Próximo**: 09_Procedimientos_Operativos.md